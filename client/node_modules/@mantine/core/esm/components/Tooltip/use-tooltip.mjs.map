{"version":3,"file":"use-tooltip.mjs","sources":["../../../src/components/Tooltip/use-tooltip.ts"],"sourcesContent":["import { useState, useCallback } from 'react';\nimport {\n  useFloating,\n  flip,\n  arrow,\n  offset,\n  shift,\n  useInteractions,\n  useHover,\n  useFocus,\n  useRole,\n  useDismiss,\n  useDelayGroupContext,\n  useDelayGroup,\n  inline,\n} from '@floating-ui/react';\nimport { useId, useDidUpdate } from '@mantine/hooks';\nimport { useTooltipGroupContext } from './TooltipGroup/TooltipGroup.context';\nimport { FloatingAxesOffsets, FloatingPosition, useFloatingAutoUpdate } from '../Floating';\n\ninterface UseTooltip {\n  position: FloatingPosition;\n  closeDelay?: number;\n  openDelay?: number;\n  onPositionChange?(position: FloatingPosition): void;\n  opened?: boolean;\n  offset: number | FloatingAxesOffsets;\n  arrowRef?: React.RefObject<HTMLDivElement>;\n  arrowOffset?: number;\n  events?: { hover: boolean; focus: boolean; touch: boolean };\n  positionDependencies: any[];\n  inline?: boolean;\n}\n\nexport function useTooltip(settings: UseTooltip) {\n  const [uncontrolledOpened, setUncontrolledOpened] = useState(false);\n  const controlled = typeof settings.opened === 'boolean';\n  const opened = controlled ? settings.opened : uncontrolledOpened;\n  const withinGroup = useTooltipGroupContext();\n  const uid = useId();\n\n  const { delay: groupDelay, currentId, setCurrentId } = useDelayGroupContext();\n\n  const onChange = useCallback(\n    (_opened: boolean) => {\n      setUncontrolledOpened(_opened);\n\n      if (_opened) {\n        setCurrentId(uid);\n      }\n    },\n    [setCurrentId, uid]\n  );\n\n  const {\n    x,\n    y,\n    context,\n    refs,\n    update,\n    placement,\n    middlewareData: { arrow: { x: arrowX, y: arrowY } = {} },\n  } = useFloating({\n    placement: settings.position,\n    open: opened,\n    onOpenChange: onChange,\n    middleware: [\n      offset(settings.offset),\n      shift({ padding: 8 }),\n      flip(),\n      arrow({ element: settings.arrowRef!, padding: settings.arrowOffset }),\n      ...(settings.inline ? [inline()] : []),\n    ],\n  });\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([\n    useHover(context, {\n      enabled: settings.events?.hover,\n      delay: withinGroup ? groupDelay : { open: settings.openDelay, close: settings.closeDelay },\n      mouseOnly: !settings.events?.touch,\n    }),\n    useFocus(context, { enabled: settings.events?.focus, keyboardOnly: true }),\n    useRole(context, { role: 'tooltip' }),\n    // cannot be used with controlled tooltip, page jumps\n    useDismiss(context, { enabled: typeof settings.opened === undefined }),\n    useDelayGroup(context, { id: uid }),\n  ]);\n\n  useFloatingAutoUpdate({\n    opened,\n    position: settings.position,\n    positionDependencies: settings.positionDependencies,\n    floating: { refs, update },\n  });\n\n  useDidUpdate(() => {\n    settings.onPositionChange?.(placement);\n  }, [placement]);\n\n  const isGroupPhase = opened && currentId && currentId !== uid;\n\n  return {\n    x,\n    y,\n    arrowX,\n    arrowY,\n    reference: refs.setReference,\n    floating: refs.setFloating,\n    getFloatingProps,\n    getReferenceProps,\n    isGroupPhase,\n    opened,\n    placement,\n  };\n}\n"],"names":[],"mappings":"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"}