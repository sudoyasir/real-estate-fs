{"version":3,"file":"create-aria-hider.mjs","sources":["../../src/use-focus-trap/create-aria-hider.ts"],"sourcesContent":["import { randomId } from '../utils';\n\ninterface Value {\n  node: HTMLElement;\n  ariaHidden: string | null;\n}\n\nexport function createAriaHider(\n  containerNode: HTMLElement,\n  selector: string = 'body > :not(script)'\n) {\n  const id = randomId();\n\n  const rootNodes: (Value | undefined)[] = Array.from<HTMLElement>(\n    document.querySelectorAll(selector)\n  ).map((node) => {\n    if (node?.shadowRoot?.contains(containerNode) || node.contains(containerNode)) {\n      return undefined;\n    }\n\n    const ariaHidden = node.getAttribute('aria-hidden');\n    const prevAriaHidden = node.getAttribute('data-hidden');\n    const prevFocusId = node.getAttribute('data-focus-id');\n\n    node.setAttribute('data-focus-id', id);\n\n    if (ariaHidden === null || ariaHidden === 'false') {\n      node.setAttribute('aria-hidden', 'true');\n    } else if (!prevAriaHidden && !prevFocusId) {\n      node.setAttribute('data-hidden', ariaHidden);\n    }\n\n    return {\n      node,\n      ariaHidden: prevAriaHidden || null,\n    };\n  });\n\n  return () => {\n    rootNodes.forEach((item) => {\n      if (!item || id !== item.node.getAttribute('data-focus-id')) {\n        return;\n      }\n\n      if (item.ariaHidden === null) {\n        item.node.removeAttribute('aria-hidden');\n      } else {\n        item.node.setAttribute('aria-hidden', item.ariaHidden);\n      }\n\n      item.node.removeAttribute('data-focus-id');\n      item.node.removeAttribute('data-hidden');\n    });\n  };\n}\n"],"names":[],"mappings":";;;AACO,SAAS,eAAe,CAAC,aAAa,EAAE,QAAQ,GAAG,qBAAqB,EAAE;AACjF,EAAE,MAAM,EAAE,GAAG,QAAQ,EAAE,CAAC;AACxB,EAAE,MAAM,SAAS,GAAG,KAAK,CAAC,IAAI;AAC9B,IAAI,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC;AACvC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK;AAClB,IAAI,IAAI,EAAE,CAAC;AACX,IAAI,IAAI,CAAC,CAAC,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC,UAAU,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;AACxI,MAAM,OAAO,KAAK,CAAC,CAAC;AACpB,KAAK;AACL,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;AACxD,IAAI,MAAM,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;AAC5D,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;AAC3D,IAAI,IAAI,CAAC,YAAY,CAAC,eAAe,EAAE,EAAE,CAAC,CAAC;AAC3C,IAAI,IAAI,UAAU,KAAK,IAAI,IAAI,UAAU,KAAK,OAAO,EAAE;AACvD,MAAM,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;AAC/C,KAAK,MAAM,IAAI,CAAC,cAAc,IAAI,CAAC,WAAW,EAAE;AAChD,MAAM,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;AACnD,KAAK;AACL,IAAI,OAAO;AACX,MAAM,IAAI;AACV,MAAM,UAAU,EAAE,cAAc,IAAI,IAAI;AACxC,KAAK,CAAC;AACN,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,MAAM;AACf,IAAI,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;AAChC,MAAM,IAAI,CAAC,IAAI,IAAI,EAAE,KAAK,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE;AACnE,QAAQ,OAAO;AACf,OAAO;AACP,MAAM,IAAI,IAAI,CAAC,UAAU,KAAK,IAAI,EAAE;AACpC,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;AACjD,OAAO,MAAM;AACb,QAAQ,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;AAC/D,OAAO;AACP,MAAM,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;AACjD,MAAM,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;AAC/C,KAAK,CAAC,CAAC;AACP,GAAG,CAAC;AACJ;;"}